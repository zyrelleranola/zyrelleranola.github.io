/*
 * jQuery Carousel Plugin for WYSIWYG Web Builder 9
 * Copyright Pablo Software solutions 2013
 * http://www.wysiwygwebbuilder.com/
 */
(function(e){e.fn.carousel=function(g){var d={delay:3E3,duration:500,easing:"linear",mode:"forward",pagination:!0,pagination_img_default:"",pagination_img_active:"",start:0},m;m=g&&"string"==typeof g?g:e.extend(d,g);return this.each(function(){e.carousel(this,m)})};e.carousel=function(g,d){function m(b,c){var a=b.data("carousel");if("forward-backward"==a.mode)0==a.currentFrame&&(c=0),a.currentFrame==a.count-1&&(c=1),a.direction=c;else if("forward-circular"==a.mode||"backward-circular"==a.mode){if(0==
a.currentFrame&&1==c){var d=a.currentFrame;a.currentFrame=a.count-1;a.pagination&&k(b,d,a.currentFrame);b.find(".frame:last").css({display:"block",position:"relative","float":"right",left:-1*(a.total_width+a.width*a.currentFrame)+"px"});b.stop().animate({left:"+="+a.width},a.duration,a.easing,function(){b.css("left","-"+(a.total_width-a.width)+"px");b.find(".frame:last").css({left:-1*a.width*a.currentFrame+"px"});j(b,a.width*a.currentFrame,0,a.easing)});return!1}if(a.currentFrame==a.count-1&&0==c){d=
a.currentFrame;a.currentFrame=0;a.pagination&&k(b,d,a.currentFrame);b.find(".frame:first").css({position:"relative",left:a.total_width+"px"});b.stop().animate({left:"-="+a.width},a.duration,a.easing,function(){b.css("left","0px");b.find(".frame:first").css("left","0px");j(b,a.width*a.currentFrame,0,a.easing)});return}}0==c?u(b):v(b);"forward-backward"==a.mode&&(e("#"+b.attr("id")+"_next").css("display",a.currentFrame==a.count-1?"none":"block"),e("#"+b.attr("id")+"_back").css("display",0==a.currentFrame?
"none":"block"))}function v(b){var c=b.data("carousel"),a=c.currentFrame;c.currentFrame=0==c.currentFrame?c.count-1:Math.max(c.currentFrame-1,0);c.pagination&&k(b,a,c.currentFrame);j(b,c.width*c.currentFrame,c.duration,c.easing)}function u(b){var c=b.data("carousel"),a=c.currentFrame;c.currentFrame=c.currentFrame==c.count-1?0:Math.min(c.currentFrame+1,c.count-1);c.pagination&&k(b,a,c.currentFrame);j(b,c.width*c.currentFrame,c.duration,c.easing)}function w(b,c){p(b);var a=b.data("carousel"),d=a.currentFrame;
a.currentFrame=Math.min(c-1,a.count-1);a.pagination&&k(b,d,a.currentFrame);j(b,a.width*a.currentFrame,a.duration,a.easing);"forward-backward"==a.mode&&(e("#"+b.attr("id")+"_next").css("display",a.currentFrame==a.count-1?"none":"block"),e("#"+b.attr("id")+"_back").css("display",0==a.currentFrame?"none":"block"))}function p(b){b=b.data("timerId");clearInterval(b)}function k(b,c,a){b=b.data("carousel");document.getElementById("page_"+String(c+1)).src=b.pagination_img_default;document.getElementById("page_"+
String(a+1)).src=b.pagination_img_active}function j(b,c,a,d){b.animate({left:-c},a,d)}function z(b){q=b.targetTouches[0].pageX;r=b.targetTouches[0].pageY;s=q;t=r;p($carousel)}function A(b){b.preventDefault();s=b.targetTouches[0].pageX;t=b.targetTouches[0].pageY;var c=s-q,a=t-r;b=Math.round(Math.sqrt(Math.pow(c,2)+Math.pow(a,2)));c=x(c,a);"left"==c?j($carousel,f.width*f.currentFrame+b,0,""):"right"==c&&j($carousel,f.width*f.currentFrame-b,0,"")}function B(b){var c=s-q,a=t-r;50<=Math.round(Math.sqrt(Math.pow(c,
2)+Math.pow(a,2)))?(b=x(c,a),"left"==b?u($carousel):"right"==b&&v($carousel)):y(b)}function y(){t=s=r=q=0;j($carousel,f.width*f.currentFrame,f.duration,f.easing)}function x(b,c){var a=Math.atan2(c,-b),a=Math.round(180*a/Math.PI);0>a&&(a=360-Math.abs(a));return 45>=a&&0<=a||360>=a&&315<=a?"left":135<=a&&225>=a?"right":45<a&&135>a?"down":"up"}var q=0,r=0,s=0,t=0;$carousel=e(g);if(d&&"string"==typeof d)if("next"==d)p($carousel),m($carousel,0);else if("prev"==d)p($carousel),m($carousel,1);else{if(-1!=
d.indexOf("goto")){p($carousel);var h=d.slice(5);w($carousel,h)}}else{var h=$carousel.find(".frame"),l=$carousel.parent(),n=0;if("backward"==d.mode||"backward-circular"==d.mode)n=1;var f={count:h.length,currentFrame:0,direction:n,duration:d.duration,easing:d.easing,killtimer:d.killtimer,mode:d.mode,pagination:d.pagination,pagination_img_default:d.pagination_img_default,pagination_img_active:d.pagination_img_active,width:l.outerWidth(),total_width:l.outerWidth()*h.length};$carousel.css("width",f.total_width+
"px");$carousel.data("carousel",f);if(d.pagination){$pagination=e('<div class="pagination" />');for(l=0;l<h.length;l++)n=e("<a />").attr("id",String(l+1)).css("cursor","pointer"),e("<img />").attr({id:"page_"+String(l+1),src:d.pagination_img_default}).appendTo(n),n.click(function(){w($carousel,e(this).attr("id"))}),n.appendTo($pagination);$pagination.appendTo($carousel.parent());k($carousel,0,0)}0!=d.start&&(f.currentFrame=d.start,f.pagination&&k($carousel,0,f.currentFrame),j($carousel,f.width*f.currentFrame,
0,""));"forward-backward"==d.mode&&(0==d.start&&e("#"+$carousel.attr("id")+"_back").css("display","none"),d.start>=h.length-1&&e("#"+$carousel.attr("id")+"_next").css("display","none"));0!=d.delay&&(h=setInterval(function(){m($carousel,$carousel.data("carousel").direction)},d.delay),$carousel.data("timerId",h));h="Microsoft Internet Explorer"==navigator.appName?!1:!0;h&&(g.addEventListener("touchstart",z,!1),g.addEventListener("touchmove",A,!1),g.addEventListener("touchend",B,!1),g.addEventListener("touchcancel",
y,!1))}}})(jQuery);